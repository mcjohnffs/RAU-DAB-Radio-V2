# BM83

## BM83 über USB Programmieren (Grundeinstellungen)

### Software requirements
- [IS2083 Software & Tools](http://ww1.microchip.com/downloads/en/DeviceDoc/IS2083%20Software%20&%20Tools%20(v1.0.3).zip)

### Hardware requirements
- BM83 Modul- Breakout mit Male Headers
- USB Kabel mit Female Headers (2.54) für 
    - ( +5V – (Rot)
    - GND – (Schwarz)
    - Data - (Weiss)
    - Data+ - (Grün)



| BM83        | USB          |
| ------------- |:-------------:|
| ADAP_IN (22)      | +5 V (Rot) |
| GND (50)      | GND (Schwarz)      |
| DM (36) | Data- (Weiss)     |
| DP (37) | Data+ (Grün)      | 

![BM83_1](/assets/images/bm83_1.png)

### Grundeinstellung konfigurieren

Im Ordner „IS2083 Software&Tools (v1.0.3)“ unter „Software\Turnkey Package\Host Mode“ befindet sich die Demo Konfiguration für den Host MCU Mode. Wir verwenden diese Konfiguration um die Grundeinstellung für das DAB Radio zu konfigurieren und die Steuerung über einen externen Mikrocontroller zu ermöglichen.

Die Konfiguration erfolgt über das Tool „IS208x_Config_GUI_Tool“ welches sich im Unter-Ordner „Tools\Config Tool“ befindet.

Nach dem Start des Config Tools muss zuerst die Demo Konfiguration geladen werden.
Dies erfolgt per klick des „Load“ Buttons.

![BM83_2](/assets/images/bm83_2.png)

![BM83_3](/assets/images/bm83_3.png)

Nach erfolgreichem Laden der Demo Konfiguration werden folgende Grundeinstellung gesetzt.

#### Im Reiter Sys. Setup1 
- Power Switch Type -> Uart CMD Power On
- UART Baudrate -> 9600 
#### Im Reiter Sys. Setup2 
- Simple Pairing -> Enable
- Security -> Simple Pairing -> Disable -> Neuen Pin setzen
- Misc Option -> Enter Pairing Mode When Power On -> Enable
- Class of Device -> Speaker
#### Im Reiter PMU Setup
- Battery Detection -> Enable
- Low Battery Warning Level -> 3.1V
- Battery Shutdown Level -> 3.0V
#### Im Reiter CODEC Setup
- CODEC Function -> Speaker Output -> Single End External Amp.
- CODEC Function -> CODEC Output Type -> Internal codec
- Audio Equalizer Setting -> Equalizer Function -> Disable

Um die Einstellungen zu beenden und im nächsten Schritt zu speichern auf «Finish» klicken.
Es öffnet sich ein weiteres Fenster zur Einstellung der DSP Funktionen. Dieses ignorieren und auf «X» rechts oben klicken.

![BM83_finish](/assets/images/bm83_finish.png)

Um die Konfiguration zu speichern auf «Save» im Hauptmenü des Config Tools klicken.

![BM83_save](/assets/images/bm83_save.png)

## Flashen der Konfiguration über USB

Um neu erstellte Konfiguration auf das Bluetooth Modul zu laden, wird hierzu das Tool « isUpdate Tool» verwendet. Dies befindet sich im Unter-Ordner «Tools\isUpdate Tool».

#### Einstellungen des isUpdate Tools
- Port: USB-HID
- Image num: 1
- Memory: flash
- Subtype: serial flash

#### Verbinden des Moduls

Nach erfolgreichem Verbinden wird die Verbindung zum Bluetooth Modul per «Connect» Button getätigt.

![BM83_connect](/assets/images/bm83_connect.png)

#### Mögliche Meldungen/Fehlermeldungen
- Verbindung erfolgreich -> Meldung : USB HID is connected
- Verbindung fehlgeschlagen -> Meldung : Connect failed -> Verbindungen überprüfen

#### Firmware updaten

Mit dem Button «Browse» wird die vorherige erstellte Konfiguration ausgewählt.
Um die Konfiguration auf das Bluetooth Modul zu laden, wird der Button «Update» getätigt.

![BM83_update](/assets/images/bm83_update.png)

!!! warning "Wichtig"
    Bevor das Modul ausgesteckt wird, muss die Verbindung zwingend mit "Disconnect" getrennt werden.
